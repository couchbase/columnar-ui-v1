{"version":3,"file":"rx.js","sources":["../../node_modules/@uirouter/rx/lib-esm/ui-router-rx.js","../../node_modules/@uirouter/rx/lib-esm/rx-async-policy.js"],"sourcesContent":["/** @module rx */\n/** */\nimport { ReplaySubject } from 'rxjs';\nimport { map, mergeMap, filter } from 'rxjs/operators';\n/** Augments UIRouterGlobals with observables for transition starts, successful transitions, and state parameters */\nvar UIRouterRx = /** @class */ (function () {\n    function UIRouterRx(router) {\n        this.name = '@uirouter/rx';\n        this.deregisterFns = [];\n        var start$ = new ReplaySubject(1);\n        var success$ = start$.pipe(mergeMap(function (t) { return t.promise.then(function () { return t; }, function () { return null; }); }), filter(function (t) { return !!t; }));\n        var params$ = success$.pipe(map(function (transition) { return transition.params(); }));\n        var states$ = new ReplaySubject(1);\n        function onStatesChangedEvent(event, states) {\n            var changeEvent = {\n                currentStates: router.stateRegistry.get(),\n                registered: [],\n                deregistered: [],\n            };\n            if (event)\n                changeEvent[event] = states;\n            states$.next(changeEvent);\n        }\n        this.deregisterFns.push(router.transitionService.onStart({}, function (transition) { return start$.next(transition); }));\n        this.deregisterFns.push(router.stateRegistry.onStatesChanged(onStatesChangedEvent));\n        onStatesChangedEvent(null, null);\n        Object.assign(router.globals, { start$: start$, success$: success$, params$: params$, states$: states$ });\n    }\n    UIRouterRx.prototype.dispose = function () {\n        this.deregisterFns.forEach(function (deregisterFn) { return deregisterFn(); });\n        this.deregisterFns = [];\n    };\n    return UIRouterRx;\n}());\nexport { UIRouterRx };\nexport var UIRouterRxPlugin = UIRouterRx;\n//# sourceMappingURL=ui-router-rx.js.map","import { Observable, of } from 'rxjs';\nimport { first, shareReplay } from 'rxjs/operators';\n/**\n * Determines the unwrapping behavior of asynchronous resolve values.\n *\n *   - When an Observable is returned from the resolveFn, wait until the Observable emits at least one item.\n *     If any other value will be converted to an Observable that emits such value.\n *   - The Observable item will not be unwrapped.\n *   - The Observable stream itself will be provided when the resolve is injected or bound elsewhere.\n *\n * #### Example:\n *\n * The `Transition` will wait for the `main.home` resolve observables to emit their first value.\n * Promises will be unwrapped and returned as observables before being provided to components.\n * ```js\n * var mainState = {\n *   name: 'main',\n *   resolve: mainResolves, // defined elsewhere\n *   resolvePolicy: { async: RXWAIT },\n * }\n * ```\n */\nexport function RXWAIT(resolveFnValue) {\n    if (!(resolveFnValue instanceof Observable)) {\n        resolveFnValue = of(resolveFnValue);\n    }\n    var data$ = resolveFnValue.pipe(shareReplay(1));\n    return data$\n        .pipe(first())\n        .toPromise()\n        .then(function () {\n        return data$;\n    });\n}\n//# sourceMappingURL=rx-async-policy.js.map"],"names":["UIRouterRx","router","this","name","deregisterFns","start$","ReplaySubject","success$","pipe","mergeMap","t","promise","then","filter","params$","map","transition","params","states$","onStatesChangedEvent","event","states","changeEvent","currentStates","stateRegistry","get","registered","deregistered","next","push","transitionService","onStart","onStatesChanged","Object","assign","globals","prototype","dispose","forEach","deregisterFn","UIRouterRxPlugin","RXWAIT","resolveFnValue","Observable","of","data$","shareReplay","first","toPromise"],"mappings":"2MAKG,IAACA,EAA4B,WAC5B,SAASA,EAAWC,GAChBC,KAAKC,KAAO,eACZD,KAAKE,cAAgB,GACrB,IAAIC,EAAS,IAAIC,EAAc,GAC3BC,EAAWF,EAAOG,KAAKC,GAAS,SAAUC,GAAK,OAAOA,EAAEC,QAAQC,MAAK,WAAc,OAAOF,KAAM,WAAc,OAAO,WAAcG,GAAO,SAAUH,GAAK,QAASA,MAClKI,EAAUP,EAASC,KAAKO,GAAI,SAAUC,GAAc,OAAOA,EAAWC,aACtEC,EAAU,IAAIZ,EAAc,GAChC,SAASa,EAAqBC,EAAOC,GACjC,IAAIC,EAAc,CACdC,cAAetB,EAAOuB,cAAcC,MACpCC,WAAY,GACZC,aAAc,IAEdP,IACAE,EAAYF,GAASC,GACzBH,EAAQU,KAAKN,GAEjBpB,KAAKE,cAAcyB,KAAK5B,EAAO6B,kBAAkBC,QAAQ,IAAI,SAAUf,GAAc,OAAOX,EAAOuB,KAAKZ,OACxGd,KAAKE,cAAcyB,KAAK5B,EAAOuB,cAAcQ,gBAAgBb,IAC7DA,EAAqB,KAAM,MAC3Bc,OAAOC,OAAOjC,EAAOkC,QAAS,CAAE9B,OAAQA,EAAQE,SAAUA,EAAUO,QAASA,EAASI,QAASA,IAMnG,OAJAlB,EAAWoC,UAAUC,QAAU,WAC3BnC,KAAKE,cAAckC,SAAQ,SAAUC,GAAgB,OAAOA,OAC5DrC,KAAKE,cAAgB,IAElBJ,KAGAwC,EAAmBxC,ECbvB,SAASyC,EAAOC,GACbA,aAA0BC,IAC5BD,EAAiBE,EAAGF,IAExB,IAAIG,EAAQH,EAAelC,KAAKsC,EAAY,IAC5C,OAAOD,EACFrC,KAAKuC,KACLC,YACApC,MAAK,WACN,OAAOiC"}