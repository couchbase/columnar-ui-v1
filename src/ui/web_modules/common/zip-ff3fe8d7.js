import{b as t}from"./tslib.es6-c4a4947b.js";import{S as e,a as r,b as n,O as i,g as o,h as s,f as u,k as c,l as h,d as a,y as l}from"./mergeMap-bab8a89f.js";import{A as p,a as f,e as d}from"./ReplaySubject-432677af.js";function b(t,e,r,n){return function(i){return i.lift(new y(t,e,r,n))}}var y=function(){function t(t,e,r,n){this.keySelector=t,this.elementSelector=e,this.durationSelector=r,this.subjectSelector=n}return t.prototype.call=function(t,e){return e.subscribe(new v(t,this.keySelector,this.elementSelector,this.durationSelector,this.subjectSelector))},t}(),v=function(e){function n(t,r,n,i,o){var s=e.call(this,t)||this;return s.keySelector=r,s.elementSelector=n,s.durationSelector=i,s.subjectSelector=o,s.groups=null,s.attemptedToUnsubscribe=!1,s.count=0,s}return t(n,e),n.prototype._next=function(t){var e;try{e=this.keySelector(t)}catch(t){return void this.error(t)}this._group(t,e)},n.prototype._group=function(t,e){var n=this.groups;n||(n=this.groups=new Map);var i,o=n.get(e);if(this.elementSelector)try{i=this.elementSelector(t)}catch(t){this.error(t)}else i=t;if(!o){o=this.subjectSelector?this.subjectSelector():new r,n.set(e,o);var s=new g(e,o,this);if(this.destination.next(s),this.durationSelector){var u=void 0;try{u=this.durationSelector(new g(e,o))}catch(t){return void this.error(t)}this.add(u.subscribe(new m(e,o,this)))}}o.closed||o.next(i)},n.prototype._error=function(t){var e=this.groups;e&&(e.forEach((function(e,r){e.error(t)})),e.clear()),this.destination.error(t)},n.prototype._complete=function(){var t=this.groups;t&&(t.forEach((function(t,e){t.complete()})),t.clear()),this.destination.complete()},n.prototype.removeGroup=function(t){this.groups.delete(t)},n.prototype.unsubscribe=function(){this.closed||(this.attemptedToUnsubscribe=!0,0===this.count&&e.prototype.unsubscribe.call(this))},n}(n),m=function(e){function r(t,r,n){var i=e.call(this,r)||this;return i.key=t,i.group=r,i.parent=n,i}return t(r,e),r.prototype._next=function(t){this.complete()},r.prototype._unsubscribe=function(){var t=this.parent,e=this.key;this.key=this.parent=null,t&&t.removeGroup(e)},r}(n),g=function(r){function n(t,e,n){var i=r.call(this)||this;return i.key=t,i.groupSubject=e,i.refCountSubscription=n,i}return t(n,r),n.prototype._subscribe=function(t){var r=new e,n=this.refCountSubscription,i=this.groupSubject;return n&&!n.closed&&r.add(new x(n)),r.add(i.subscribe(t)),r},n}(i),x=function(e){function r(t){var r=e.call(this)||this;return r.parent=t,t.count++,r}return t(r,e),r.prototype.unsubscribe=function(){var t=this.parent;t.closed||this.closed||(e.prototype.unsubscribe.call(this),t.count-=1,0===t.count&&t.attemptedToUnsubscribe&&t.unsubscribe())},r}(e),S=function(r){function n(){var t=null!==r&&r.apply(this,arguments)||this;return t.value=null,t.hasNext=!1,t.hasCompleted=!1,t}return t(n,r),n.prototype._subscribe=function(t){return this.hasError?(t.error(this.thrownError),e.EMPTY):this.hasCompleted&&this.hasNext?(t.next(this.value),t.complete(),e.EMPTY):r.prototype._subscribe.call(this,t)},n.prototype.next=function(t){this.hasCompleted||(this.value=t,this.hasNext=!0)},n.prototype.error=function(t){this.hasCompleted||r.prototype.error.call(this,t)},n.prototype.complete=function(){this.hasCompleted=!0,this.hasNext&&r.prototype.next.call(this,this.value),r.prototype.complete.call(this)},n}(r),w=1,C={};var _=function(t){var e=w++;return C[e]=t,Promise.resolve().then((function(){return function(t){var e=C[t];e&&e()}(e)})),e},j=function(t){delete C[t]},k=function(e){function r(t,r){var n=e.call(this,t,r)||this;return n.scheduler=t,n.work=r,n}return t(r,e),r.prototype.requestAsyncId=function(t,r,n){return void 0===n&&(n=0),null!==n&&n>0?e.prototype.requestAsyncId.call(this,t,r,n):(t.actions.push(this),t.scheduled||(t.scheduled=_(t.flush.bind(t,null))))},r.prototype.recycleAsyncId=function(t,r,n){if(void 0===n&&(n=0),null!==n&&n>0||null===n&&this.delay>0)return e.prototype.recycleAsyncId.call(this,t,r,n);0===t.actions.length&&(j(r),t.scheduled=void 0)},r}(p),E=new(function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return t(r,e),r.prototype.flush=function(t){this.active=!0,this.scheduled=void 0;var e,r=this.actions,n=-1,i=r.length;t=t||r.shift();do{if(e=t.execute(t.state,t.delay))break}while(++n<i&&(t=r.shift()));if(this.active=!1,e){for(;++n<i&&(t=r.shift());)t.unsubscribe();throw e}},r}(f))(k),A=new f(p),I=function(){function t(){return Error.call(this),this.message="Timeout has occurred",this.name="TimeoutError",this}return t.prototype=Object.create(Error.prototype),t}();function N(t){return new i((function(e){var r;try{r=t()}catch(t){return void e.error(t)}return(r?o(r):d()).subscribe(e)}))}function T(t){return!s(t)&&t-parseFloat(t)+1>=0}function F(t,e){function r(){return!r.pred.apply(r.thisArg,arguments)}return r.pred=t,r.thisArg=e,r}function R(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(1===t.length){if(!s(t[0]))return t[0];t=t[0]}return u(t,void 0).lift(new U)}var U=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new V(t))},t}(),V=function(e){function r(t){var r=e.call(this,t)||this;return r.hasFirst=!1,r.observables=[],r.subscriptions=[],r}return t(r,e),r.prototype._next=function(t){this.observables.push(t)},r.prototype._complete=function(){var t=this.observables,e=t.length;if(0===e)this.destination.complete();else{for(var r=0;r<e&&!this.hasFirst;r++){var n=t[r],i=c(this,n,n,r);this.subscriptions&&this.subscriptions.push(i),this.add(i)}this.observables=null}},r.prototype.notifyNext=function(t,e,r,n,i){if(!this.hasFirst){this.hasFirst=!0;for(var o=0;o<this.subscriptions.length;o++)if(o!==r){var s=this.subscriptions[o];s.unsubscribe(),this.remove(s)}this.subscriptions=null}this.destination.next(e)},r}(h);function M(t,e,r){void 0===t&&(t=0);var n=-1;return T(e)?n=Number(e)<1?1:Number(e):a(e)&&(r=e),a(r)||(r=A),new i((function(e){var i=T(t)?t:+t-r.now();return r.schedule(G,i,{index:0,period:n,subscriber:e})}))}function G(t){var e=t.index,r=t.period,n=t.subscriber;if(n.next(e),!n.closed){if(-1===r)return n.complete();t.index=e+1,this.schedule(t,r)}}function O(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=t[t.length-1];return"function"==typeof r&&t.pop(),u(t,void 0).lift(new P(r))}var P=function(){function t(t){this.resultSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new q(t,this.resultSelector))},t}(),q=function(e){function r(t,r,n){void 0===n&&(n=Object.create(null));var i=e.call(this,t)||this;return i.iterators=[],i.active=0,i.resultSelector="function"==typeof r?r:null,i.values=n,i}return t(r,e),r.prototype._next=function(t){var e=this.iterators;s(t)?e.push(new z(t)):"function"==typeof t[l]?e.push(new Y(t[l]())):e.push(new Z(this.destination,this,t))},r.prototype._complete=function(){var t=this.iterators,e=t.length;if(this.unsubscribe(),0!==e){this.active=e;for(var r=0;r<e;r++){var n=t[r];if(n.stillUnsubscribed)this.destination.add(n.subscribe(n,r));else this.active--}}else this.destination.complete()},r.prototype.notifyInactive=function(){this.active--,0===this.active&&this.destination.complete()},r.prototype.checkIterators=function(){for(var t=this.iterators,e=t.length,r=this.destination,n=0;n<e;n++){if("function"==typeof(s=t[n]).hasValue&&!s.hasValue())return}var i=!1,o=[];for(n=0;n<e;n++){var s,u=(s=t[n]).next();if(s.hasCompleted()&&(i=!0),u.done)return void r.complete();o.push(u.value)}this.resultSelector?this._tryresultSelector(o):r.next(o),i&&r.complete()},r.prototype._tryresultSelector=function(t){var e;try{e=this.resultSelector.apply(this,t)}catch(t){return void this.destination.error(t)}this.destination.next(e)},r}(n),Y=function(){function t(t){this.iterator=t,this.nextResult=t.next()}return t.prototype.hasValue=function(){return!0},t.prototype.next=function(){var t=this.nextResult;return this.nextResult=this.iterator.next(),t},t.prototype.hasCompleted=function(){var t=this.nextResult;return t&&t.done},t}(),z=function(){function t(t){this.array=t,this.index=0,this.length=0,this.length=t.length}return t.prototype[l]=function(){return this},t.prototype.next=function(t){var e=this.index++,r=this.array;return e<this.length?{value:r[e],done:!1}:{value:null,done:!0}},t.prototype.hasValue=function(){return this.array.length>this.index},t.prototype.hasCompleted=function(){return this.array.length===this.index},t}(),Z=function(e){function r(t,r,n){var i=e.call(this,t)||this;return i.parent=r,i.observable=n,i.stillUnsubscribed=!0,i.buffer=[],i.isComplete=!1,i}return t(r,e),r.prototype[l]=function(){return this},r.prototype.next=function(){var t=this.buffer;return 0===t.length&&this.isComplete?{value:null,done:!0}:{value:t.shift(),done:!1}},r.prototype.hasValue=function(){return this.buffer.length>0},r.prototype.hasCompleted=function(){return 0===this.buffer.length&&this.isComplete},r.prototype.notifyComplete=function(){this.buffer.length>0?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()},r.prototype.notifyNext=function(t,e,r,n,i){this.buffer.push(e),this.parent.checkIterators()},r.prototype.subscribe=function(t,e){return c(this,this.observable,this,e)},r}(h);export{S as A,g as G,I as T,P as Z,A as a,E as b,N as d,b as g,T as i,F as n,R as r,M as t,O as z};
//# sourceMappingURL=zip-ff3fe8d7.js.map
