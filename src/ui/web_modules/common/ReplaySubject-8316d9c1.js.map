{"version":3,"file":"ReplaySubject-8316d9c1.js","sources":["../../node_modules/rxjs/_esm5/internal/scheduler/QueueAction.js","../../node_modules/rxjs/_esm5/internal/scheduler/queue.js","../../node_modules/rxjs/_esm5/internal/scheduler/QueueScheduler.js","../../node_modules/rxjs/_esm5/internal/operators/observeOn.js","../../node_modules/rxjs/_esm5/internal/ReplaySubject.js"],"sourcesContent":["/** PURE_IMPORTS_START tslib,_AsyncAction PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { AsyncAction } from './AsyncAction';\nvar QueueAction = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(QueueAction, _super);\n    function QueueAction(scheduler, work) {\n        var _this = _super.call(this, scheduler, work) || this;\n        _this.scheduler = scheduler;\n        _this.work = work;\n        return _this;\n    }\n    QueueAction.prototype.schedule = function (state, delay) {\n        if (delay === void 0) {\n            delay = 0;\n        }\n        if (delay > 0) {\n            return _super.prototype.schedule.call(this, state, delay);\n        }\n        this.delay = delay;\n        this.state = state;\n        this.scheduler.flush(this);\n        return this;\n    };\n    QueueAction.prototype.execute = function (state, delay) {\n        return (delay > 0 || this.closed) ?\n            _super.prototype.execute.call(this, state, delay) :\n            this._execute(state, delay);\n    };\n    QueueAction.prototype.requestAsyncId = function (scheduler, id, delay) {\n        if (delay === void 0) {\n            delay = 0;\n        }\n        if ((delay !== null && delay > 0) || (delay === null && this.delay > 0)) {\n            return _super.prototype.requestAsyncId.call(this, scheduler, id, delay);\n        }\n        return scheduler.flush(this);\n    };\n    return QueueAction;\n}(AsyncAction));\nexport { QueueAction };\n//# sourceMappingURL=QueueAction.js.map\n","/** PURE_IMPORTS_START _QueueAction,_QueueScheduler PURE_IMPORTS_END */\nimport { QueueAction } from './QueueAction';\nimport { QueueScheduler } from './QueueScheduler';\nexport var queue = /*@__PURE__*/ new QueueScheduler(QueueAction);\n//# sourceMappingURL=queue.js.map\n","/** PURE_IMPORTS_START tslib,_AsyncScheduler PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { AsyncScheduler } from './AsyncScheduler';\nvar QueueScheduler = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(QueueScheduler, _super);\n    function QueueScheduler() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    return QueueScheduler;\n}(AsyncScheduler));\nexport { QueueScheduler };\n//# sourceMappingURL=QueueScheduler.js.map\n","/** PURE_IMPORTS_START tslib,_Subscriber,_Notification PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { Subscriber } from '../Subscriber';\nimport { Notification } from '../Notification';\nexport function observeOn(scheduler, delay) {\n    if (delay === void 0) {\n        delay = 0;\n    }\n    return function observeOnOperatorFunction(source) {\n        return source.lift(new ObserveOnOperator(scheduler, delay));\n    };\n}\nvar ObserveOnOperator = /*@__PURE__*/ (function () {\n    function ObserveOnOperator(scheduler, delay) {\n        if (delay === void 0) {\n            delay = 0;\n        }\n        this.scheduler = scheduler;\n        this.delay = delay;\n    }\n    ObserveOnOperator.prototype.call = function (subscriber, source) {\n        return source.subscribe(new ObserveOnSubscriber(subscriber, this.scheduler, this.delay));\n    };\n    return ObserveOnOperator;\n}());\nexport { ObserveOnOperator };\nvar ObserveOnSubscriber = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(ObserveOnSubscriber, _super);\n    function ObserveOnSubscriber(destination, scheduler, delay) {\n        if (delay === void 0) {\n            delay = 0;\n        }\n        var _this = _super.call(this, destination) || this;\n        _this.scheduler = scheduler;\n        _this.delay = delay;\n        return _this;\n    }\n    ObserveOnSubscriber.dispatch = function (arg) {\n        var notification = arg.notification, destination = arg.destination;\n        notification.observe(destination);\n        this.unsubscribe();\n    };\n    ObserveOnSubscriber.prototype.scheduleMessage = function (notification) {\n        var destination = this.destination;\n        destination.add(this.scheduler.schedule(ObserveOnSubscriber.dispatch, this.delay, new ObserveOnMessage(notification, this.destination)));\n    };\n    ObserveOnSubscriber.prototype._next = function (value) {\n        this.scheduleMessage(Notification.createNext(value));\n    };\n    ObserveOnSubscriber.prototype._error = function (err) {\n        this.scheduleMessage(Notification.createError(err));\n        this.unsubscribe();\n    };\n    ObserveOnSubscriber.prototype._complete = function () {\n        this.scheduleMessage(Notification.createComplete());\n        this.unsubscribe();\n    };\n    return ObserveOnSubscriber;\n}(Subscriber));\nexport { ObserveOnSubscriber };\nvar ObserveOnMessage = /*@__PURE__*/ (function () {\n    function ObserveOnMessage(notification, destination) {\n        this.notification = notification;\n        this.destination = destination;\n    }\n    return ObserveOnMessage;\n}());\nexport { ObserveOnMessage };\n//# sourceMappingURL=observeOn.js.map\n","/** PURE_IMPORTS_START tslib,_Subject,_scheduler_queue,_Subscription,_operators_observeOn,_util_ObjectUnsubscribedError,_SubjectSubscription PURE_IMPORTS_END */\nimport * as tslib_1 from \"tslib\";\nimport { Subject } from './Subject';\nimport { queue } from './scheduler/queue';\nimport { Subscription } from './Subscription';\nimport { ObserveOnSubscriber } from './operators/observeOn';\nimport { ObjectUnsubscribedError } from './util/ObjectUnsubscribedError';\nimport { SubjectSubscription } from './SubjectSubscription';\nvar ReplaySubject = /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(ReplaySubject, _super);\n    function ReplaySubject(bufferSize, windowTime, scheduler) {\n        if (bufferSize === void 0) {\n            bufferSize = Number.POSITIVE_INFINITY;\n        }\n        if (windowTime === void 0) {\n            windowTime = Number.POSITIVE_INFINITY;\n        }\n        var _this = _super.call(this) || this;\n        _this.scheduler = scheduler;\n        _this._events = [];\n        _this._infiniteTimeWindow = false;\n        _this._bufferSize = bufferSize < 1 ? 1 : bufferSize;\n        _this._windowTime = windowTime < 1 ? 1 : windowTime;\n        if (windowTime === Number.POSITIVE_INFINITY) {\n            _this._infiniteTimeWindow = true;\n            _this.next = _this.nextInfiniteTimeWindow;\n        }\n        else {\n            _this.next = _this.nextTimeWindow;\n        }\n        return _this;\n    }\n    ReplaySubject.prototype.nextInfiniteTimeWindow = function (value) {\n        var _events = this._events;\n        _events.push(value);\n        if (_events.length > this._bufferSize) {\n            _events.shift();\n        }\n        _super.prototype.next.call(this, value);\n    };\n    ReplaySubject.prototype.nextTimeWindow = function (value) {\n        this._events.push(new ReplayEvent(this._getNow(), value));\n        this._trimBufferThenGetEvents();\n        _super.prototype.next.call(this, value);\n    };\n    ReplaySubject.prototype._subscribe = function (subscriber) {\n        var _infiniteTimeWindow = this._infiniteTimeWindow;\n        var _events = _infiniteTimeWindow ? this._events : this._trimBufferThenGetEvents();\n        var scheduler = this.scheduler;\n        var len = _events.length;\n        var subscription;\n        if (this.closed) {\n            throw new ObjectUnsubscribedError();\n        }\n        else if (this.isStopped || this.hasError) {\n            subscription = Subscription.EMPTY;\n        }\n        else {\n            this.observers.push(subscriber);\n            subscription = new SubjectSubscription(this, subscriber);\n        }\n        if (scheduler) {\n            subscriber.add(subscriber = new ObserveOnSubscriber(subscriber, scheduler));\n        }\n        if (_infiniteTimeWindow) {\n            for (var i = 0; i < len && !subscriber.closed; i++) {\n                subscriber.next(_events[i]);\n            }\n        }\n        else {\n            for (var i = 0; i < len && !subscriber.closed; i++) {\n                subscriber.next(_events[i].value);\n            }\n        }\n        if (this.hasError) {\n            subscriber.error(this.thrownError);\n        }\n        else if (this.isStopped) {\n            subscriber.complete();\n        }\n        return subscription;\n    };\n    ReplaySubject.prototype._getNow = function () {\n        return (this.scheduler || queue).now();\n    };\n    ReplaySubject.prototype._trimBufferThenGetEvents = function () {\n        var now = this._getNow();\n        var _bufferSize = this._bufferSize;\n        var _windowTime = this._windowTime;\n        var _events = this._events;\n        var eventsCount = _events.length;\n        var spliceCount = 0;\n        while (spliceCount < eventsCount) {\n            if ((now - _events[spliceCount].time) < _windowTime) {\n                break;\n            }\n            spliceCount++;\n        }\n        if (eventsCount > _bufferSize) {\n            spliceCount = Math.max(spliceCount, eventsCount - _bufferSize);\n        }\n        if (spliceCount > 0) {\n            _events.splice(0, spliceCount);\n        }\n        return _events;\n    };\n    return ReplaySubject;\n}(Subject));\nexport { ReplaySubject };\nvar ReplayEvent = /*@__PURE__*/ (function () {\n    function ReplayEvent(time, value) {\n        this.time = time;\n        this.value = value;\n    }\n    return ReplayEvent;\n}());\n//# sourceMappingURL=ReplaySubject.js.map\n"],"names":["QueueAction","_super","scheduler","work","_this","call","this","tslib_1.__extends","prototype","schedule","state","delay","flush","execute","closed","_execute","requestAsyncId","id","AsyncAction","queue","QueueScheduler","apply","arguments","AsyncScheduler","observeOn","source","lift","ObserveOnOperator","subscriber","subscribe","ObserveOnSubscriber","destination","dispatch","arg","notification","observe","unsubscribe","scheduleMessage","add","ObserveOnMessage","_next","value","Notification","createNext","_error","err","createError","_complete","createComplete","Subscriber","ReplaySubject","bufferSize","windowTime","Number","POSITIVE_INFINITY","_events","_infiniteTimeWindow","_bufferSize","_windowTime","next","nextInfiniteTimeWindow","nextTimeWindow","push","length","shift","ReplayEvent","_getNow","_trimBufferThenGetEvents","_subscribe","subscription","len","ObjectUnsubscribedError","isStopped","hasError","Subscription","EMPTY","observers","SubjectSubscription","i","error","thrownError","complete","now","eventsCount","spliceCount","time","Math","max","splice","Subject"],"mappings":"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"}