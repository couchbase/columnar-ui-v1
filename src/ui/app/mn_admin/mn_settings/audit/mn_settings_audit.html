<div class="audit_container when-enterprise only-when-40" mn-spinner="mnSettingsAuditController.viewLoading">
  <h2>Audit Configuration</h2>
  <p class="sub_section">
    Auditing keeps track of important admin events occurring in Couchbase. Keeping track and persisting these events is essential for any secured environment and provides evidence for suspicious/malicious activity in Couchbase.
  </p>
  <form ng-submit="mnSettingsAuditController.submit()" name="auditForm">
    <div class="sub_section" style="margin-right:0;">
      <div class="row">
        <label>
          <span>Enable:</span>
          <input
            type="checkbox"
            ng-model="mnSettingsAuditController.state.auditdEnabled"
            ng-disabled="mnSettingsAuditController.mnPoolDefault.value.isROAdminCreds">
        </label>
      </div>
      <div class="row">
        <label>
          <span>Target log directory:</span>
          <input
            ng-model="mnSettingsAuditController.state.logPath"
            ng-disabled="!mnSettingsAuditController.state.auditdEnabled"
            class="archive_path_field">
        </label>
        <i ng-if="mnSettingsAuditController.errors.logPath" class="error-container">
          {{mnSettingsAuditController.errors.logPath}}
        </i>
      </div>
      <div class="row">
        <label>
          <span>Log rotation time interval:</span>
          <input
            ng-model="mnSettingsAuditController.state.rotateInterval"
            ng-disabled="!mnSettingsAuditController.state.auditdEnabled"
            type="number"
            style="width:67px;">
        </label>
        <select
          ng-model="mnSettingsAuditController.state.rotateUnit"
          ng-disabled="!mnSettingsAuditController.state.auditdEnabled"
          style="width:75px;">
            <option value="minutes">Minutes</option>
            <option value="hours">Hours</option>
            <option value="days">Days</option>
        </select>
        <i
          ng-if="mnSettingsAuditController.errors.rotateInterval"
          class="error-container">
            {{mnSettingsAuditController.errors.rotateInterval}}
        </i>
      </div>
    </div>
    <div class="save_cancel">
      <button
        ng-disabled="!!mnSettingsAuditController.errors || auditForm.$pristine"
        class="save_button float_right"
        ng-hide="mnSettingsAuditController.mnPoolDefault.value.isROAdminCreds">Save</button>
    </div>
  </form>
</div>